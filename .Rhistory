ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_discrete(limits = c("under.40", "40.to.80", "80.to.120", "120.or.more")) +
scale_fill_manual(values = c("#F4E5B6", "#C98293", "#B4C6A6", "#9D8CB2")) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = "",  # Optional: specify legend title here
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
# scale_fill_manual(
#     values = c("under.40" = "#F4E5B6",
#                "40.to.80" = "#C98293",
#                "80.to.120" = "#B4C6A6",
#                "120.or.more" = "#9D8CB2"),
#     name = "",  # Optional: specify legend title here
#     labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
# ) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
data <- tibble::tribble(
~Categoty, ~under.40, ~`40.to.80`, ~`80.to.120`, ~`120.or.more`,
"renters",       44L,         29L,          14L,            13L,
"home owners",   22L,         29L,          19L,            30L
) %>%
pivot_longer(cols = 2:ncol(.))
# Calculate the cumulative sum of the values and the midpoint for labels
data2 <- data %>%
group_by(Categoty) %>%
arrange(desc(name)) %>%  # Ensures that the order is consistent
mutate(cumulative = cumsum(value),
midpoint = cumulative - value / 2,
label = paste0(value, "%"))
# Define the desired order for the legend
desired_order <- c("under.40", "40.to.80", "80.to.120", "120.or.more")
data2$name <- factor(data2$name, levels = desired_order)
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(values = c("#F4E5B6", "#C98293", "#B4C6A6", "#9D8CB2"),
name = "",  # Optional: you can specify legend title here
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")) +  # Customize labels if needed
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
data <- tibble::tribble(
~Categoty, ~under.40, ~`40.to.80`, ~`80.to.120`, ~`120.or.more`,
"renters",       44L,         29L,          14L,            13L,
"home owners",   22L,         29L,          19L,            30L
) %>%
pivot_longer(cols = 2:ncol(.))
# Calculate the cumulative sum of the values and the midpoint for labels
data2 <- data %>%
group_by(Categoty) %>%
arrange(name) %>%  # Ensures the order is correct
mutate(cumulative = cumsum(value),
midpoint = cumulative - value / 2,
label = paste0(value, "%"))
# Define the desired order for the legend
desired_order <- c("under.40", "40.to.80", "80.to.120", "120.or.more")
data2$name <- factor(data2$name, levels = desired_order)
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(values = c("#F4E5B6", "#C98293", "#B4C6A6", "#9D8CB2"),
name = "",  # Optional: you can specify legend title here
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")) +  # Customize labels if needed
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
data <- tibble::tribble(
~Categoty, ~under.40, ~`40.to.80`, ~`80.to.120`, ~`120.or.more`,
"renters",       44L,         29L,          14L,            13L,
"home owners",   22L,         29L,          19L,            30L
) %>%
pivot_longer(cols = 2:ncol(.), names_to = "name", values_to = "value")
# Calculate the cumulative sum of the values and the midpoint for labels
data2 <- data %>%
group_by(Categoty) %>%
mutate(cumulative = cumsum(value),
midpoint = cumulative - value / 2,
label = paste0(value, "%")) %>%
ungroup() %>%
arrange(Categoty, factor(name, levels = c("under.40", "40.to.80", "80.to.120", "120.or.more")))
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(values = c("#F4E5B6", "#C98293", "#B4C6A6", "#9D8CB2"),
name = "",  # Optional: you can specify legend title here
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")) +  # Customize labels if needed
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
# scale_fill_manual(
#     values = c("under.40" = "#F4E5B6",
#                "40.to.80" = "#C98293",
#                "80.to.120" = "#B4C6A6",
#                "120.or.more" = "#9D8CB2"),
#     name = "",  # Optional: specify legend title here
#     labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
# ) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
# Calculate the cumulative sum of the values and the midpoint for labels
data2 <- data %>%
group_by(Categoty) %>%
arrange(desc(name)) %>%  # Ensures that the order is consistent
mutate(cumulative = cumsum(value),
midpoint = cumulative - value / 2,
label = paste0(value, "%"))
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
# scale_fill_manual(
#     values = c("under.40" = "#F4E5B6",
#                "40.to.80" = "#C98293",
#                "80.to.120" = "#B4C6A6",
#                "120.or.more" = "#9D8CB2"),
#     name = "",  # Optional: specify legend title here
#     labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
# ) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
# scale_fill_manual(
#     values = c("under.40" = "#F4E5B6",
#                "40.to.80" = "#C98293",
#                "80.to.120" = "#B4C6A6",
#                "120.or.more" = "#9D8CB2"),
#     name = "",  # Optional: specify legend title here
#     labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
# ) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = "",  # Optional: specify legend title here
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
D9A7B3
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = "",
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")  # Customize labels if needed
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = "",
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#9D8CB2",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#F4E5B6"),
name = "",
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = "",
labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
desired_order <- c("under.40", "40.to.80", "80.to.120", "120.or.more")
data2$name <- factor(data2$name, levels = desired_order)
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Calculate the cumulative sum of the values and the midpoint for labels
data2 <- data %>%
group_by(Categoty) %>%
arrange(desc(name)) %>%  # Ensures that the order is consistent
mutate(cumulative = cumsum(value),
midpoint = cumulative - value / 2,
label = paste0(value, "%"))
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 10)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_text(size = 0)
) +
labs(fill = "")
# Create the hollow pie chart
ggplot(data2, aes(x = 2, y = value, fill = name)) +
geom_bar(stat = "identity", width = 1, color = "gray30") +
coord_polar(theta = "y") +
facet_grid(~str_to_title(Categoty)) +
geom_text(aes(y = midpoint, label = label), color = "gray20", size = 5) +  # Add labels
xlim(0.5, 2.5) +  # Adjusts the inner and outer radius to create the hollow effect
theme_void() +    # Removes all background and axis elements
scale_fill_manual(
values = c("under.40" = "#F4E5B6",
"40.to.80" = "#C98293",
"80.to.120" = "#B4C6A6",
"120.or.more" = "#9D8CB2"),
name = ""
# labels = c("Under 40", "40 to 80", "80 to 120", "120 or more")
) +
theme(
legend.position = "bottom",
strip.text.x = element_blank()
) +
labs(fill = "")
